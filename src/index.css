@tailwind base;
@tailwind components;
@tailwind utilities;

/* Twisted Fairytale Halloween Design System
All colors are HSL for consistency. Motion respects prefers-reduced-motion.
*/

@layer base {
  :root {
    /* Core Gothic Theme Colors */
    --bg: 219 8% 4%; /* #0B0B0C - Deep charcoal */
    --bg-2: 226 35% 17%; /* #1A1F3A - Midnight purple */
    --ink: 0 0% 93%; /* #EDEDED - Soft white */
    
    /* Fairytale Accent Palette */
    --accent-purple: 285 46% 21%; /* #3B1F4A - Enchanted purple */
    --accent-green: 142 25% 33%; /* #3B6E47 - Forest green */
    --accent-red: 0 100% 27%; /* #8B0000 - Blood red */
    --accent-gold: 44 35% 57%; /* #C5A45D - Ancient gold */
    
    /* Semantic Mappings */
    --background: var(--bg);
    --foreground: var(--ink);
    --card: var(--bg-2);
    --card-foreground: var(--ink);
    --popover: var(--bg-2);
    --popover-foreground: var(--ink);
    --primary: var(--accent-purple);
    --primary-foreground: var(--ink);
    --secondary: var(--bg-2);
    --secondary-foreground: var(--ink);
    --muted: var(--bg-2);
    --muted-foreground: 0 0% 65%;
    --accent: var(--accent-gold);
    --accent-foreground: var(--bg);
    --destructive: var(--accent-red);
    --destructive-foreground: var(--ink);
    --border: 226 35% 25%;
    --input: var(--bg-2);
    --ring: var(--accent-purple);
    --radius: 0.75rem;
    
    /* Component-specific */
    --navbar-bg: rgba(59, 31, 74, 0.95); /* Translucent purple */
    --hero-overlay: rgba(11, 11, 12, 0.6);
    --glow-purple: rgba(197, 164, 93, 0.3);
    --glow-gold: rgba(197, 164, 93, 0.5);
  }
}

@layer base {
  * {
    @apply border-border;
  }
  
  body {
    @apply bg-background text-foreground font-body;
    /* Smooth scrolling for better UX */
  scroll-behavior: smooth;
  
  /* Text shadows for hero overlay */
  --text-shadow-gothic: 2px 2px 4px hsl(var(--bg) / 0.8), 
                        0 0 8px hsl(var(--accent-purple) / 0.6);
  }
  
  /* Typography scale */
  .font-heading {
    font-family: 'Cinzel Decorative', serif;
  }
  
  .font-subhead {
    font-family: 'IM Fell English SC', serif;
  }
  
  .font-body {
    font-family: 'Inter', sans-serif;
  }
  
  /* Focus visible for accessibility */
  .focus-visible {
    @apply outline-none ring-2 ring-accent ring-offset-2 ring-offset-background;
  }
  
  /* Global consistent focus ring */
  :where(button, [href], input, select, textarea, [tabindex]):focus-visible {
    outline: 2px solid hsl(var(--accent-gold));
    outline-offset: 2px;
  }
  
  /* Motion system - respects user preferences */
  .motion-safe {
    transition: all 0.2s ease-out;
  }
  
  @media (prefers-reduced-motion: reduce) {
    .motion-safe {
      transition: none;
    }
    
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }
}

@layer components {
  /* Hunt rune found state enhancement */
  .hunt-rune[aria-pressed="true"] { 
    filter: saturate(1.1) brightness(1.1); 
  }
  
  /* Section reveal styles */
  .reveal {
    opacity: 0;
    transform: translateY(10px);
  }

  .reveal--shown {
    opacity: 1;
    transform: translateY(0);
    animation: rise-fade 450ms ease-out both;
  }

  @media (prefers-reduced-motion: reduce) {
    .reveal, .reveal--shown { 
      animation: none !important; 
      transform: none !important; 
      opacity: 1 !important; 
    }
  }
  
  /* Glow effects for interactive elements */
  .glow-purple {
    box-shadow: 0 0 20px var(--glow-purple);
  }
  
  .glow-gold {
    box-shadow: 0 0 20px var(--glow-gold);
  }
  
  /* Gothic text shadow for headings */
  .text-shadow-gothic {
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
  }
  
  /* Hover tilt effect */
  .hover-tilt {
    transition: transform 0.2s ease-out;
  }
  
  .hover-tilt:hover {
    transform: rotate(-2deg) scale(1.02);
  }
  
  @media (prefers-reduced-motion: reduce) {
    .hover-tilt:hover {
      transform: none;
    }
  }
  
  /* Micro-interactions with motion safety */
  .motion-safe\:hover\:scale-\[1\.01\]:hover {
    transform: scale(1.01);
  }
  
  .motion-safe\:active\:scale-\[0\.99\]:active {
    transform: scale(0.99);
  }
  
  .motion-safe\:hover\:-translate-y-0\.5:hover {
    transform: translateY(-0.125rem);
  }
  
  /* Fade in animations */
  .animate-fade-in {
    animation: fade-in 0.6s ease-out;
  }
  
  .animate-scale-in {
    animation: scale-in 0.3s ease-out;
  }
  
  .animation-delay-300 {
    animation-delay: 0.3s;
  }
  
  .animation-delay-600 {
    animation-delay: 0.6s;
  }
  
  /* Interactive Elements */
  .story-link {
    @apply relative inline-block after:content-[''] after:absolute after:w-full after:scale-x-0 after:h-0.5 after:bottom-0 after:left-0 after:bg-accent-gold after:origin-bottom-right after:transition-transform after:duration-300 hover:after:scale-x-100 hover:after:origin-bottom-left;
  }

  .hover-scale {
    @apply transition-transform duration-200 hover:scale-105;
  }

  .hover-tilt {
    @apply transition-transform duration-300 hover:rotate-1;
  }

  .glow-gold {
    @apply shadow-[0_0_20px_hsl(var(--accent-gold)/0.3)] hover:shadow-[0_0_30px_hsl(var(--accent-gold)/0.5)];
  }

  .text-shadow-gothic {
    text-shadow: var(--text-shadow-gothic);
  }
}

@keyframes rise-fade {
  from { opacity: 0; transform: translateY(10px); }
  to   { opacity: 1; transform: translateY(0); }
}

@keyframes fade-in {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* --- Smoky Fog Effect --- */
.smoky-fog::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  background: 
    radial-gradient(600px circle at var(--mouse-x, 50%) var(--mouse-y, 50%), 
      rgba(139, 69, 19, 0.15), 
      transparent 40%),
    radial-gradient(800px circle at calc(var(--mouse-x, 50%) - 200px) calc(var(--mouse-y, 50%) + 100px), 
      rgba(75, 0, 130, 0.1), 
      transparent 40%),
    rgba(0, 0, 0, 0.4);
  animation: smokeDrift 20s ease-in-out infinite;
  z-index: -1;
}

@keyframes smokeDrift {
  0%, 100% { 
    background-position: 0% 0%, 100% 100%;
  }
  25% { 
    background-position: 100% 0%, 0% 100%;
  }
  50% { 
    background-position: 100% 100%, 0% 0%;
  }
  75% { 
    background-position: 0% 100%, 100% 0%;
  }
}

/* Track mouse for interactive fog */
:root {
  --mouse-x: 50%;
  --mouse-y: 50%;
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  .smoky-fog::before { 
    animation: none !important; 
    background: rgba(0, 0, 0, 0.4);
  }
}

/* --- Auto Fog System --- */
@layer utilities {
  /* Section scoping helpers */
  .fog-scope {
    position: relative;
    isolation: isolate;    /* keep z-index local */
    overflow: hidden;      /* prevent bleed */
  }
  
  .fog-mount {
    position: absolute;
    inset: 0;
    z-index: 0;            /* behind content */
    pointer-events: none;
    contain: paint;
  }
  
  .fog-content {
    position: relative;
    z-index: 1;            /* keep content on top */
  }

  /* Optional: guard for navs, modals, etc. (never auto-fog these) */
  .fog-opt-out, 
  nav, 
  [role="dialog"], 
  .modal, 
  .drawer { 
    --fog-opt-out: 1; 
  }

  /* Fog background base styles */
  .fog-background {
    background: 
      radial-gradient(600px circle at var(--mouse-x, 50%) var(--mouse-y, 50%), 
        rgba(100, 100, 120, 0.15) 0%, 
        rgba(50, 50, 70, 0.08) 40%, 
        transparent 70%),
      radial-gradient(800px circle at calc(var(--mouse-x, 50%) + 200px) calc(var(--mouse-y, 50%) - 100px), 
        rgba(80, 80, 100, 0.1) 0%, 
        transparent 50%);
    animation: smokeDrift 20s ease-in-out infinite;
  }

  /* Intensity variations */
  .fog-intensity-low .fog-background {
    opacity: 0.4;
  }
  
  .fog-intensity-md .fog-background {
    opacity: 0.7;
  }
  
  .fog-intensity-high .fog-background {
    opacity: 1;
  }

  /* Speed variations */
  .fog-speed-slow .fog-background {
    animation-duration: 30s;
  }
  
  .fog-speed-medium .fog-background {
    animation-duration: 20s;
  }
  
  .fog-speed-fast .fog-background {
    animation-duration: 10s;
  }

  /* Tint variations */
  .fog-tint-purple .fog-background {
    background: 
      radial-gradient(600px circle at var(--mouse-x, 50%) var(--mouse-y, 50%), 
        rgba(120, 80, 150, 0.15) 0%, 
        rgba(80, 50, 100, 0.08) 40%, 
        transparent 70%),
      radial-gradient(800px circle at calc(var(--mouse-x, 50%) + 200px) calc(var(--mouse-y, 50%) - 100px), 
        rgba(100, 60, 130, 0.1) 0%, 
        transparent 50%);
  }
  
  .fog-tint-gold .fog-background {
    background: 
      radial-gradient(600px circle at var(--mouse-x, 50%) var(--mouse-y, 50%), 
        rgba(200, 150, 80, 0.15) 0%, 
        rgba(150, 120, 60, 0.08) 40%, 
        transparent 70%),
      radial-gradient(800px circle at calc(var(--mouse-x, 50%) + 200px) calc(var(--mouse-y, 50%) - 100px), 
        rgba(180, 140, 70, 0.1) 0%, 
        transparent 50%);
  }

  /* Static fog for reduced motion / mobile */
  .fog-static .fog-background {
    animation: none !important;
    background: rgba(60, 60, 80, 0.2);
  }

  /* Paused state for hidden tabs */
  .fog-paused .fog-background {
    animation-play-state: paused;
  }
}

/* Respect reduced motion for fog system */
@media (prefers-reduced-motion: reduce) {
  .fog-background { 
    animation: none !important; 
    background: rgba(60, 60, 80, 0.15) !important;
  }
}
